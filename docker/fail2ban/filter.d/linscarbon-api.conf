# Fail2Ban filter for LinsCarbon API rate limiting
# Detects API abuse attempts

[Definition]
failregex = ^\[\d{4}-\d{2}-\d{2}[T ]\d{2}:\d{2}:\d{2}.*\] .*(local|production)\.WARNING: API rate limit exceeded.*"ip":"<HOST>"
            ^\[\d{4}-\d{2}-\d{2}[T ]\d{2}:\d{2}:\d{2}.*\] .*(local|production)\.WARNING: Invalid API token.*"ip":"<HOST>"
            ^\[\d{4}-\d{2}-\d{2}[T ]\d{2}:\d{2}:\d{2}.*\] .*(local|production)\.WARNING: Unauthorized API access.*"ip":"<HOST>"

ignoreregex =

[Init]
datepattern = ^\[%%Y-%%m-%%d[T ]%%H:%%M:%%S
