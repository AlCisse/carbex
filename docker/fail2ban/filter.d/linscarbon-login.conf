# Fail2Ban filter for LinsCarbon login attempts
# Detects failed login attempts in Laravel logs

[Definition]
failregex = ^\[\d{4}-\d{2}-\d{2}[T ]\d{2}:\d{2}:\d{2}.*\] .*(local|production)\.WARNING: Failed login attempt.*"ip":"<HOST>"
            ^\[\d{4}-\d{2}-\d{2}[T ]\d{2}:\d{2}:\d{2}.*\] .*(local|production)\.WARNING: Authentication failed.*"ip":"<HOST>"
            ^\[\d{4}-\d{2}-\d{2}[T ]\d{2}:\d{2}:\d{2}.*\] .*(local|production)\.WARNING: Too many login attempts.*"ip":"<HOST>"

ignoreregex =

[Init]
datepattern = ^\[%%Y-%%m-%%d[T ]%%H:%%M:%%S
